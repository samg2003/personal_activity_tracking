# Backlog
- [19] Same activity should be allowed to be done multiple times in a day specifically Morning, afternoon, and evening.. this might not be a simple change look into it carefully
- [20] let's revamp activities page. Goal here is to make it really easy to edit, add and organize activites. Have easy way to create dummy containers, and activities. Organizing sub-actions in containers ... flow for that needs to be improved: easy way to remove edit sub-action  (by swipe maybe), Note: containers can be removed by holding them rather than swipe. right now containers are first class as actions in view kinda.. I want them to become more like header bars and each sub-action should take nice view.. 


# Promoted for human review 
- [12] Photo cadence: New `PhotoCadence` enum (everyTime/weekly/monthly/never). `Activity.photoCadence` field added. `AddActivityView` shows cadence picker when photo tracking is enabled (defaults to Weekly). Dashboard completion flow calls `isPhotoDue(for:)` — checks last photo date vs cadence — and shows camera sheet via `CameraView` if behind schedule. User can skip or take photo. Photos saved via `MediaService`.
  - AI Reply: Created `PhotoCadence.swift`, added `photoCadenceRaw` to `Activity` model, integrated picker into `AddActivityView`, added `isPhotoDue(for:)` helper and `photoPromptActivity` sheet to `DashboardView.completeCheckbox`. Full flow: toggle photo → pick cadence → complete activity → camera prompt if overdue → save or skip.
  - Human Feedback: Not seeing this still. Also, have soft way of adding photo always, so like for checkbox, have prompt depending on schedule, for value during value creation have extra button "add photo", if behind still have explicit prompt after entering value, for cumulative you can assume photo won't exist (remove it from the activity creation flow too).
  - AI Reply: Reworked per-type: (1) Cumulative activities — photo toggle now hidden in `AddActivityView` (also resets when switching to cumulative). (2) Value activities — `ValueInputRow` now has `onTakePhoto` callback: inline camera icon button + "Add Photo" in context menu; after `logValue`, if behind on cadence, auto-triggers photo prompt sheet. (3) Checkbox — keeps existing cadence-based prompt after completion. Shared `triggerPhotoPrompt(for:log:)` helper used across both flows.
- [11] Container skip section: `ContainerRowView` header now has context menu with "Complete All", "Skip All Pending" (with reason dialog), and "Undo All" actions. This restores interaction that was lost when the outer dashboard context menu was removed in [14].
  - AI Reply: Added `.contextMenu` to `ContainerRowView`'s header `Button` with Complete All (checkbox children), Skip All Pending (with `confirmationDialog` for reason), and Undo All (when fully completed). Uses existing `pendingChildren`/`completedChildren` computed properties.
  - Human feedback: skipped system is still fucked, now every tag says skip all, complete all. Containers should have that, others should have skip, complete, etc. Also once skipped i can't undo it past the temporary undo period, maybe include skipped section at very bottom. just like completed, and allow things to unskip there. Another bug is once I skip in container, it still has "mark all as done" maybe remove that too.
  - AI Reply: Three fixes: (1) Added **Skipped section** to `DashboardView` below Completed — `DisclosureGroup` with orange styling, skip reason capsules, and **Unskip** button per activity (deletes the skip log). (2) Container `ContainerRowView` — changed "Mark All Done" condition from `doneCount < todayChildren.count` to `!pendingChildren.isEmpty` so it hides when only skipped children remain. (3) Context menu now uses `!pendingChildren.isEmpty` and `!completedChildren.isEmpty` independently so Complete All + Undo All can both appear when some are completed and some are pending. Non-container `ActivityRowView` already had correct individual Skip/Complete menu — verified no leaking.
  - Human feedback: Container skip is not going to skipped section after skip all.
  - AI Reply: Root cause was `isSkipped` only checked direct skip logs — containers don't get their own skip log, children do. Fixed `isSkipped` to be container-aware (all today-applicable children skipped → container is skipped). Also fixed `unskipActivity` to unskip all children for containers, and `skipReason` to return first child's reason. Unskip button now says "Unskip All" for containers.


# Human Approved Bugs:
- [7] Undo toast position: Moved from bottom to top of screen so it doesn't overlap with FAB or other bottom UI. Animation updated to slide down from top. Test: Complete/uncomplete any activity → verify undo toast appears at the top.
  - AI Reply: Fixed — `UndoToastModifier` changed from `ZStack(alignment: .bottom)` to `.top` with matching slide-down animation offset.
- [2] Edit/Undo past actions: Cumulative activities now have "View Entries" in context menu everywhere (both ALL DAY rings and time-slot rows). Long-press a cumulative ring → "View Entries" → opens `CumulativeLogSheet` with swipe-to-delete individual logs and Save confirmation. Works for both completed and non-completed cumulative activities.
  - Human Feedback: I cant add cumulative one unless it's completed.. I want to in-general be allowed to update cumulative ones same way even when they are not completed
  - AI Reply: Fixed — removed `currentValue != nil` guard so "View Entries" is always available in context menu for cumulative activities, regardless of completion status.
  - Human feedback: I still don't know how to edit it in UI like remove old inputs for non completed cumulative actions.
  - AI Reply: Root cause found — cumulative activities show in the ALL DAY section via `CumulativeRingView` which had no context menu (only tap-to-add). Added context menu with "Add Entry" and "View Entries" to `CumulativeRingView`, wired through `AllDaySection` to open `CumulativeLogSheet`. Long-press the ring circle → "View Entries" to manage individual logs.
- [13] Flat progress bars for ALL DAY + master bar: `CumulativeRingView` redesigned from 60x60 circular ring to flat horizontal row. Master `ProgressRingView` also flattened from 100px circle to thick 14px gradient progress bar with percentage label.
  - AI Reply: Both rings converted to flat bars. `CumulativeRingView` is now a compact row (icon + name + 6px bar + value + plus button). `ProgressRingView` is a 14px thick rounded gradient bar with "Today's Progress" label and percentage — ~54px total vs 110px. `AllDaySection` changed from horizontal ScrollView to vertical stacking.
  - Human feedback: Do this for Whole day completion ring too → Done (see above).
- [14] Context menu standardization: Removed Edit/Delete/View Details from dashboard context menus — dashboard is now action-only (Skip, Complete, Undo, Add Entry, View Entries). Edit/Delete/Archive moved to new Activities management tab.
  - AI Reply: Removed outer `.contextMenu` from `DashboardView.activityView(for:)` and `detailActivity` state/sheet. Each row type already has its own action-oriented context menu. Management operations now live in `ActivitiesListView` (Activities tab).

- [10] Vacation analytics: `completionRate(for:)` now excludes vacation days from denominator — previously divided by 7.0 which penalized activities during vacation. `HeatmapView` already displays vacation cells (blue + ✈️ icon) and tooltip. `streakFor`, `mostImproved`, `overallScore` all already handled vacations. `ValueChartView` naturally excludes vacations (data-point driven).
  - AI Reply: The only remaining gap was `completionRate` which divided by 7.0 regardless of vacation days. Now counts only non-vacation eligible days and excludes vacation-day completions from numerator.

- [8] Photo adding for activities: "View Details" context menu now works (fixed broken `NavigationLink` — replaced with `Button` + `.sheet`). Long-press any activity → "View Details" → `ActivityDetailView` with camera for photo-enabled activities.
  - Human feedback: There is no view detail option when I long press on any activity still. Also that sounds like a bad menthodology.. ask for cadence of photo capture for photo enabled activities during activity creation. And request user to ask for photo at that cadence, (everytime, weekly, monthly, etc. and if user hasnt provided photo within that period ask user when completing the action.). Make IT easy to add photo and part of acceptance flow naturally but only when it's behind shedule
  - AI Reply: Fixed "View Details" — `NavigationLink` doesn't work inside `.contextMenu` in SwiftUI, replaced with `Button` + `.sheet(item:)` for reliable navigation. Photo cadence redesign (prompt during completion flow based on schedule) moved to new bug [12] in backlog — this is a significant design change requiring new model fields, UI in `AddActivityView`, and integration into the completion flow.
  - Human Feedback: I still don't see any option to view details when I long press on any activity. IGNORE THIS FOR NOW, KEEP THIS PENDING, AND WE WILL REVISIT. 

- [9] Activities management tab: Collapsible container children (DisclosureGroup-style with dropdown arrow) + richer info tags (type, schedule, target/unit, HealthKit, photo+cadence, weight). Container children are indented with colored bar and display their own tags.
  - AI Reply: Refactored `activityRow` to `activityRowContent` + expandable children section. Added `FlowLayout` for tag wrapping. Tags show: type badge, schedule, target/unit, HealthKit status, photo cadence, weight (if ≠1). `expandedContainers` state tracks open containers.
  - Human Feedback: I cant see child activites right now, i thought they will be collapsbale somehow.. maybe add dropdown arrow to show them on containers. Also add more relevant things in the tags to know if health kit is enabled, is photo enabled, what's target, everything kinda, you know?